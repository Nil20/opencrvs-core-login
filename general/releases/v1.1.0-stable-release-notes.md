# v1.1.0-stable: release notes

**OpenCRVS v1.1.0-stable** is a minor release marking the commencement of a standardised release process for OpenCRVS.  This release will be maintained for 6 months by the core development team.

The v1.1.0 release includes collective hot-fixes to stabilise the previous v1.0.1 minor patch release. &#x20;

Upgrading from v1.0.1 to v1.1.0 requires the upgrade Migration Notes to be followed precisely. &#x20;

_We strongly recommend that all implementers currently running v1.0.1 perform the upgrade to v1.1.0 as soon as possible._

__

**Breaking changes - country configuration**

v1.1.0 includes the following configuration improvements which are breaking changes.  You must merge all changes from the Farajaland master branch into your country configuration fork to retrieve all these updates as explained in the migration notes.

* The country configuration now loads the JWT public key from core from a new endpoint in the auth microservice **`"/.well-known"`**.  This improves our security processes as we can now rotate the public key without taking the stack down.  An additional benefit of this change is this also allows development teams to start the country configuration server with just `yarn dev`, rather than previously the v1.0.1 requirement to run `yarn dev <-- path to the core directory -->`.
* We fixed a bug in our provided Github Action **deploy.yml**.
* Docker Compose yml files have all been updated to support bugfixes in core.
* The core **emergency-backup-metadata.sh** and **emergency-restore-metadata.sh** scripts contained bugs which have been resolved and these scripts are now located in the country configuration server. &#x20;
* The Ansible playbooks in core, now extend an additional `playbook.yml` in the country configuration.  This allows application secrets that [LUKS](https://en.wikipedia.org/wiki/Linux\_Unified\_Key\_Setup) encrypt the manager node databases' **/data** folder to be configured as you wish.  The prop **encrypt\_passphrase** has been renamed to **disk\_encryption\_key** to more accurately reflect the use case of this value.  The disk\__encryption\__key is saved into a file at the location **root/disk-encryption-key.txt** The script `decrypt.sh` is run on a system reboot, as we noticed that on reboot the data folder would not mount until it is decrypted.  Mongo DB and Elasticsearch passwords are saved into an example text file **opencrvs.secrets** inside the encrypted **data/** folder.  We do not advise that the **opencrvs.secrets** & **disk-encryption-key.txt**  files are used in production.  You should reconfigure the playbook and the reading of these secrets from the decrypt, backup and restore scripts, to instead provide them via an API from a [Hardware Security Module](https://en.wikipedia.org/wiki/Hardware\_security\_module) (HSM).  Secret storage is outside the scope of OpenCRVS in this release.  In the December OpenCRVS release v.1.2.0 we intend to show an example of how an HSM could be configured.  In the meantime, MOSIP's documentation on the requirements of a [Hardware Security Module](https://docs.mosip.io/1.1.5/build-and-deploy/hardware-security-module-hsm-specifications) is useful reading.&#x20;
*   The following translation keys have been added: `"config.application.updatingeMessage": "Updating..."`

    `"constants.requestReason": "Reason for request"`

    `"form.field.label.updatingUser": "Updating user"`

    `"form.field.label.creatingNewUser": "Creating new user"`

    `"form.section.user.preview.title": "Confirm details"`

    `"record.certificate.collectedInAdvance": "Printed in advance by"`

All other code amends to the country configuration support core bugfixes and features and are not breaking.



**Breaking changes - core**

v1.1.0 includes the following improvements which are breaking changes.  Core migrations are performed automatically when you upgrade and run this release as explained in the migration notes.

* Bugfix [OCRVS-3561](https://github.com/opencrvs/opencrvs-core/issues/3683): When registering a birth, a document "Legal Guardian Proof" was entered into the database mistakenly as "Informant's Birth Certificate".  An automatic migration finds any such entries and correctly labels the document.
* Bugfix related to [OCRVS-2641](https://github.com/opencrvs/opencrvs-core/issues/2641):  When improving our demo data generator script to more accurately reflect "real" Field Agent performance, we noticed that the timestamp saved to InfluxDB marking when the Field Agent commenced the application was incorrectly set to the timestamp associated with the last edit on the application.  An automatic migration finds any such entries and correctly sets the timestamp.
* An automatic migration adds a new channel /confirm/registration to OpenHIM so that the payload between country configuration BRN generation and core workflow service can be monitored in OpenHIM. Additionally log retention for all OpenHIM channels is hardocded to 30 days.  This saves approximately 20GB of storage space on a production server every year.

For a full list of all updates, see [https://github.com/opencrvs/opencrvs-core/releases](https://github.com/opencrvs/opencrvs-core/releases).&#x20;

### Major Features

The following explains in more detail each major feature that has been included in this release.

#### Migration microservice

In this release a new "migration" microservice has been introduced to core to support a simper upgrade procedure for system administrators.  This microservice utilises the package [migrate-mongo](https://github.com/oneralon/migrate-mongo-ts) and performs automatic breaking change core migrations.  This means that a system implementer will never need to manually install, store and run database migration files.

#### Record audit

All actions that are performed on a record are tracked, audited and displayed to the user when downloading details of a record. This download process is also tracked and audited in order to understand which users have had access to personally identifiable information. This feature allows users to easily monitor changes to the status of the declaration, any corrections that have been made to it and audit any access requested to personally identifiable information of a citizen by any civil registration staff member.

#### Registration form configuration user interface

Previously, birth and death form configuration was managed via a complicated JSON file in the country configuration repository. There is now an easy to use, form configuration user interface for National System Administrators to draft, edit, preview, test and publish the declaration forms. The old JSON approach has been deprecated.

#### Application configuration user interface

Previously, application settings such as fees, registration target deadlines, country logo and phone number validation regular expressions, were managed manually via text config files in the country configuration repository. There is now an easy to use, application configuration user interface for National System Administrators to configure these values. The old config file approach has been deprecated.

#### Certificate configuration user interface

Previously, certificate configuration was managed via a complicated JSON file in the country configuration repository. There is now an easy to use, certificate configuration user interface for National System Administrators that allows them to upload an SVG design with handlebars for registration data. The certificates can be previewed and printed in this interface. The old JSON approach has been deprecated.

#### Birth and death form default configuration refresh

The default, standardised OpenCRVS recommended birth and death form configuration comes pre-packaged in OpenCRVS. The question flow has been further optimised after feedback from our OpenSource community of civil registrars.

#### Performance improvements

The Performance user interface has been completed refreshed. It now includes detailed analytics on completeness rates, sources of applications, declaration status, field agent performance, breakdown of nationwide to specific office analytics and comparison between number of registrars and population numbers.

#### New user roles (National Registrar, National System Administrator, Performance Manager)

The **National Registrar** role has been created. This is a registrar's super admin and can view any record at any status nationwide as well as being able to monitor the performance of any office.&#x20;

The **National System Administrator** role has the ability to configure the form, certificate and application settings as well as create/edit/deactive any user nationwide.&#x20;

The **Performance Manager** role has no access to any PII in any record; they can access nationwide performance analytics only. This is an ideal 3rd party role for a statistician.

#### UI design refresh of the navigation, workqueues and other pages

System administrators who have tried out previous versions of OpenCRVS will notice a complete design refresh of the navigation, workqueues and more. The new look and feel is cleaner, easier to configure for your national needs and makes better use of screen real estate.

#### Archive / Reinstate

As long as the declaration has been submitted for review, it is now possible to archive an existing record, thus removing it from any workqueue. As every submitted declaration has a unique tracking ID, it can be retrieved in nationwide searches by a Registrar user and reinstated.

#### Conflicts

When a Registration Agent or a Registrar downloads a declaration in order to perform an action, they are "Assigned" the record. Other users will notice if they search for the same record that it is already assigned. Registration Agents must ask a Registrar to check and "Unassign" the record. This prevents users from making conflicting changes to the same record. A Registrar has the authority to "Unassign" the record from an individual who has it "Assigned" to them to overrule this process.

#### 3rd party penetration test fixes

This version of OpenCRVS has undergone another round of 3rd party security penetration testing by the consultancy [GoFore](https://gofore.com/) - [NORAD's](https://www.norad.no/) preferred security testing provider. Any issue that was discovered during the penetration test has been resolved.

#### Dependency upgrades

In this release we have forked and upgraded [Hearth](https://github.com/opencrvs/hearth), [Jembi's](https://www.jembi.org/) FHIR database server originally located [here](https://github.com/jembi/hearth). We resolved all dependencies that had any open security warning.

#### Miscellaneous bugfixes and refactor

A host of bugfixes were discovered and prioritsed by our QA team.

**For full details of all product updates, visit** [**https://github.com/opencrvs/opencrvs-core/releases**](https://github.com/opencrvs/opencrvs-core/releases)****
